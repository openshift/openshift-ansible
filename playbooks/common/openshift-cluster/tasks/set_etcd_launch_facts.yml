---
- set_fact: k8s_type="etcd"

- name: Generate etcd instance names(s)
  set_fact:
    scratch_name: "{{ cluster_id }}-{{ k8s_type }}-{{ item }}"
  register: etcd_names_output
  with_sequence: count={{ num_etcd }}

- set_fact:
    etcd_names: "{{ etcd_names_output.results | default([])
                    | oo_collect('ansible_facts')
                    | oo_collect('scratch_name') }}"

- name: Generate etcd instance private ipsÂ·
  set_fact:
    scratch_name: "{{ private_subnet }}.{{ 255 | random(1,1) }}" 
  register: etcd_ips_output
  with_sequence: count={{ num_etcd }}

- set_fact:
    etcd_ips: "{{ etcd_ips_output.results | default([])
                   | oo_collect('ansible_facts')
                   | oo_collect('scratch_name') }}" 
