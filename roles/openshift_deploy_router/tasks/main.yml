---
- name: Set nodelabel OpenShift facts
  set_fact:
      infranode_label: "{{ ocom_infra_node_label | default(openshift.common.infranode_label) }}"

- name: Deploy router
  shell: "osadm router --create --credentials=/var/lib/openshift/openshift.local.certificates/openshift-router/.kubeconfig --images=\'registry.access.redhat.com/openshift3_beta/ose-${component}:${version}\'"

- name: Set region for router
  shell: "osc update deploymentConfig router --patch='{\"apiVersion\":\"v1beta1\",\"template\":{\"controllerTemplate\":{\"podTemplate\":{\"nodeSelector\":{\"region\":\"{{infranode_label}}\"}}}}}'"
