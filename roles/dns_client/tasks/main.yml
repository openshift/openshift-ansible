---
- name: Get OpenShift facts
  openshift_facts:
    local_facts:
      hostname: "{{ openshift_hostname | default(None) }}"
      ip: "{{ openshift_ip | default(None) }}"
      public_hostname: "{{ openshift_public_hostname | default(None) }}"
      public_ip: "{{ openshift_public_ip | default(None) }}"

- name: Configure the resolver
  template: dest=/etc/resolv.conf src=resolv.conf

- name: Set hostname
  hostname: name={{ openshift.common.hostname }}

- name: Override DNS configuration
  lineinfile: dest={{ network_conf_file }} regexp=^DNS1 line=DNS1={{ dns_server }}

- name: Override DHCP DNS
  lineinfile:
    dest: "{{ dhclient_conf_file }}"
    regexp: "{{ dns_server }}"
    line: "prepend domain-name-servers {{ dns_server }};"
    create: yes
