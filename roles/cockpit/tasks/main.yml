---
- name: setup firewall
  include: firewall.yml
  static: yes

- name: Install cockpit-ws
  when: not openshift.common.is_containerized | bool
  package: name={{ item }} state=present
  with_items:
    - cockpit-ws
    - cockpit-system
    - cockpit-bridge
    - cockpit-docker
    - "{{ cockpit_plugins }}"
  register: l_result
  retries: 4
  until: l_result.rc | default(-1) == 0 or l_result.results is defined and 'No package matching' in l_result.results.0

- name: Enable cockpit-ws
  systemd:
    name: cockpit.socket
    enabled: true
    state: started
  when: not openshift.common.is_containerized | bool
