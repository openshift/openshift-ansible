dependency:
  name: galaxy
driver:
  name: docker
platforms:
- name: openshift_excluder_upgrade
  image: rhel7-ansible
  image_version: latest
  dockerfile: Dockerfile
  command: sleep infinity
  groups:
  - openshift_excluder_upgrade
provisioner:
  name: ansible
  playbooks:
    setup: ../resources/playbooks/docker/create.yml
    teardown: ../resources/playbooks/docker/destroy.yml
    converge: ../resources/playbooks/tests/upgrade_excluders.yml
  env:
    ANSIBLE_ROLES_PATH: ../../../../../roles
    ANSIBLE_FILTER_PLUGINS: ../../../../filter_plugins
  group_vars:
    all.yml:
      docker_install_version: '1.12'
      docker_upgrade_version: '1.12'
      install_enable_docker_excluder: true
      install_enable_openshift_excluder: true
      install_version: '3.4'
      r_openshift_excluder_service_type: atomic-openshift
      upgrade_enable_docker_excluder: true
      upgrade_enable_openshift_excluder: true
      upgrade_version: '3.5'
scenario:
  name: excluder_upgrade
  converge_sequence:
  - create
  - converge
  test_sequence:
  - destroy
  - create
  - converge
  #- lint
  - verify
  - destroy
verifier:
  name: testinfra
  options:
    capture: false
    s: true
    verbose: true
